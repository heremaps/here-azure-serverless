{
    "handler": "Microsoft.Compute.MultiVm",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
         {}
        ],
        "steps": [
            {
                "name": "hereConfig",
                "label": "HERE Credentials",
                "subLabel": {
                    "preValidation": "Configure the HERE credentials",
                    "postValidation": "Done"
                },
                "bladeTitle": "HERE Credentials",
                "elements": [
                  {
                    "name": "text1",
                    "type": "Microsoft.Common.InfoBox",
                    "visible": true,
                    "options": {
                      "icon": "Info",
                      "text": "Get your HERE App ID and App Code by Signing-up for FREE at https://developer.here.com",
                      "uri": "https://developer.here.com/ref/azure_marketplace_hlsfuntions?create=Freemium-Basic"
                    }
                  },
                  
                    {
                      "name": "hereAPP_ID",
                      "type": "Microsoft.Common.TextBox",
                      "label": "HERE App ID",
                      "toolTip" : "HERE App ID (https://developer.here.com/faqs#access-control)",
                      "visible": true,
                      "constraints": {
                        "required": true
                      }
                    },
                    {
                      "name": "hereAPP_CODE",
                      "type": "Microsoft.Common.TextBox",
                      "label": "HERE App Code",
                      "toolTip" : "HERE App Code (https://developer.here.com/faqs#access-control)",
                      "visible": true,
                      "constraints": {
                        "required": true
                      }
                    }
                ]
            },
            {
                "name": "storageConfig",
                "label": "Storage settings",
                "subLabel": {
                    "preValidation": "Configure the Storage",
                    "postValidation": "Done"
                },
                "bladeTitle": "Storage settings",
                "elements": [
                  {
                    "name": "text3",
                    "type": "Microsoft.Common.TextBlock",
                    "visible": true,
                    "options": {
                      "text" : "Storage account. A random string is pre-poulated, edit if required. Storage is required to keep code for functions, logs ,deployment details etc."
                    }
                  },
                  {
                      "name": "storageName",
                      "type": "Microsoft.Common.TextBox",
                      "label": "Storage Account Name",
                      "defaultValue" : "[concat('storage', skip( replace( guid(),  '-', ''), 17)) ]",
                      "toolTip" : "Provide a name for Storage Account, it will be validated upon submitting the request, an unique storage name is pre-populated",
                      "visible": true,
                      "constraints": {
                        "required": true
                      }
                  },
                  {
                      "name": "storageAccountType",
                      "type": "Microsoft.Common.DropDown",
                      "label": "Storage Account Type",
                      "defaultValue": "Standard_LRS",
                      "toolTip": "Choose a redundancy type ( local/zone/geo ) , Refer : https://docs.microsoft.com/en-us/azure/storage/common/storage-redundancy for more details.",
                      "constraints": {
                        "allowedValues": [
                          {
                            "label": "Standard_LRS",
                            "value": "Standard_LRS"
                          },
                          {
                            "label": "Standard_GRS",
                            "value": "Standard_GRS"
                          },
                          {
                            "label": "Standard_ZRS",
                            "value": "Standard_ZRS"
                          },
                          {
                            "label": "Premium_LRS",
                            "value": "Premium_LRS"
                          }
                        ],
                        "required": true
                      },
                      "visible": true
                    }
                ]
            },
            {
                "name": "functionAppConfig",
                "label": "Function App settings",
                "subLabel": {
                    "preValidation": "Configure the Function App Name",
                    "postValidation": "Done"
                },
                "bladeTitle": "Function App settings",
                "elements": [
                  {
                    "name": "text4",
                    "type": "Microsoft.Common.TextBlock",
                    "visible": true,
                    "options": {
                      "text" : "Globally unique function-app name. A random string is pre-poulated, edit if required."
                    }
                  },
                  {
                      "name": "functionAppName",
                      "type": "Microsoft.Common.TextBox",
                      "label": "Function App Name",
                      "defaultValue" : "[concat('fn-app', skip( replace( guid(),  '-', ''), 17)) ]",
                      "toolTip" : "Function App Name, it will be create as https://{{funcAppname}}.azurewebsites.net",
                      "visible": true,
                      "constraints": {
                        "required": true
                      }
                  }

                ]
            }

        ],
        "outputs": {
            "hereAPP_ID": "[steps('hereConfig').hereAPP_ID]",
            "hereAPP_CODE": "[steps('hereConfig').hereAPP_CODE]",

            "storageName": "[steps('storageConfig').storageName]",
            "storageAccountType": "[steps('storageConfig').storageAccountType]",
            
            "functionAppName": "[steps('functionAppConfig').functionAppName]"
        }
    }
}
